---
title: "final_project"
author: "Dodjivi Amekoudji, Emily Lang, Jessica Marshall, Kat Vrotsos"
format: pdf
editor: visual
bibliography: final_project.bib
csl: https://www.zotero.org/styles/apa
execute: 
  echo: false
  eval: true
  warning: false
  message: false
imbed_resources: true
---

```{r}
#| label: load-packages
#| echo: false 
#| include: false
# install.packages("here")
# install.packages("tidyverse")
library(here)
library(tidyverse)
library(ggplot2)
library(readr)
library(knitr)
library(tinytex)
```

```{r}
#| label: load-data
bmw_sales <- read_csv(here("data", "bmw_sales_data.csv"))
```

```{r}
# filter data
bmw_sales_decade <- bmw_sales %>% 
  filter(Year >= 2014)
```

# Abstract

Emily

# Introduction

Jessica

## Research Questions

What were the top three bestselling BMW models between 2014 and 2024?

Which BMW car colors were the most popular each year between 2014 and 2024?

How has the price of each of the top three bestselling BMW models changed between 2014 and 2024 by region?

How has the price and number of sales changes from 2014 to 2024 for each fuel type?

```{r}
# rank BMW models by sales volume to get top 3 popular models
# will use object bmw)decade_top3 for inline text describing top 3
bmw_decade_top3 <- bmw_sales_decade |> 
  group_by(Model) |> 
  summarize(Model_Sales = sum(Sales_Volume)) |>
  arrange(desc(Model_Sales))
```

```{r}
# select/filter to only include top 3 bestselling models and relevant variables in dataset
bmw_sales_decade <- bmw_sales_decade |>
  filter(
    Model == '7 Series' |
    Model == '3 Series' |
    Model == 'i8'
  ) |>
  mutate(Sales = Sales_Volume) |>
  select(Model, Year, Region, Color, Fuel_Type, Price_USD, Sales)
```

# Methods

Kat - identify top 3 models to filter, packages used, etc.

# Results

RQ1 :

Figure 2 shows that the BMW 3 Series had the highest sales and was the top-selling model during the decade. The BMW 7 Series also showed strong and consistent sales, followed by the BMW i8.

RQ2 :

Across all years from 2014 to 2024, White, Silver, and Red were consistently the most popular BMW car colors, showing the highest average sales in nearly every year as shown in Figure 1. White remained the top-selling color throughout most of the decade, followed closely by Silver. Red also maintained strong sales and regularly appeared among the top three colors each year.

RQ3:

Figure 3 shows that from 2014 to 2024, the prices of the BMW 3 Series, 7 Series, and i8 increased in all six regions: Africa, Asia, Europe, the Middle East, North America, and South America. The 3 Series showed the most consistent growth, especially in Asia and North America. The 7 Series fluctuated but ended higher in every region, with more increases in Asia and North America. The i8 also rose in price, with important growth in Asia and North America and moderate growth elsewhere.

RQ4:

Figure 2 shows that BMW prices for all fuel types: Diesel, Petrol, Hybrid, and Electric, increased between 2014 and 2024. Despite these price increases, Electric and Hybrid vehicles maintained relatively stable sales, indicating consistent demand. Petrol vehicles displayed moderate changes in sales, whereas Diesel vehicles showed the largest fluctuations, with frequent declines in sales when prices rose. Overall, Electric and Hybrid models demonstrated steady demand, while Diesel and Petrol models were more sensitive to price changes.

# Table 1. Average BMW Sales by Color and Year

```{r}
#| output: asis

#NEED TO USE WIDER TABLE***

# top colors by year
# Table

# 1. Average Sales by Year and Color
avgsales <- bmw_sales_decade |> 
  group_by(Year, Color) |>
  summarize(mean_sales = mean(Sales), .groups = "drop")

# 2. Summary Table (Long)
summary_table <- avgsales |>
  arrange(Year, Color)

# 3. Formatted Table
kable(
  summary_table,
  col.names = c("Year", "Color", "Mean Sales Volume"),
  caption = "Average BMW Sales by Color and Year"
)

# 4. Wide Table
summary_wide <- avgsales |>
  pivot_wider(
    names_from = Year,
    values_from = mean_sales
  )
kable(summary_wide,
      caption= "Average BMW Sales by Color and Year")

summary_stats <- avgsales |>
  group_by(Color) |>
  summarize(
    avg_sales = mean(mean_sales),
    total_sales = sum(mean_sales),
    .groups = "drop"
  )


# make data tidy again using pivot_longer
summary_tidy <- summary_wide |>
  pivot_longer(
    cols = c(`2014`:`2024`),
    names_to = 'Year',
    values_to = 'mean_sales'
  )
```

## Figure 1. Popularity of Car Color by Year

```{r}
# Figure
# ADD LABELS AND CLEAN UP

salescoloryear<- bmw_sales_decade |> 
  select(Color, Year, Sales)
avgsales<- salescoloryear |> 
  group_by(Year, Color) |>
  summarize(mean_sales = mean(Sales))

avgsales |>
ggplot(aes(Color,mean_sales)) +
geom_col(aes(fill = Color))+
  facet_wrap(~Year)+
  coord_flip()+
  guides(fill="none")+
  labs(x="Car Color",
  y="Average Sales",
  title = "Popularity of Car Color by Year") +
  scale_fill_manual(values = c("black", "blue", "gray60", "red", "slategray", "white"))
```

RQ

## Figure 2. Relationship Between BMW Price and Sales Volume

```{r}
# filter to 2014–2024, select needed variables

# bmw_price_sales <- bmw_sales %>%
# select(Year, Price_USD, Sales_Volume, Fuel_Type) %>%
# filter(Year >= 2014, Year <= 2024)

# summarize avg price and avg sales per year per fuel type

bmw_price_sales_summary <- bmw_sales_decade %>%
group_by(Year, Fuel_Type) %>%
summarize(
avg_price = mean(Price_USD, na.rm = TRUE),
avg_sales = mean(Sales, na.rm = TRUE)
)

# visualize relationship btw price and sales volume

ggplot(bmw_price_sales_summary, aes(x = avg_price, y = avg_sales, color = Fuel_Type)) +
geom_line(linewidth = 1) +
geom_point(size = 2) +
labs(
title = "Relationship Between BMW Price and Sales Volume (2014–2024)",
x = "Average Price",
y = "Average Sales Volume",
color = "Fuel Type"
) +
theme_minimal()
```

RQ

## Figure 3. Trends in BMW Model Price From 2014 to 2024 by Region

```{r}
bmw_sales_decade |>
  ggplot(aes(Year, Price_USD, color = Model)) +
  geom_smooth(se = FALSE) +
  labs(
    x = 'Year',
    y = 'Price (USD)',
    title = 'Trends in BMW Model Price From 2014 to 2024 by Region',
    subtitle = 'Top 3 Bestselling BMW Models'
  ) +
  facet_wrap(~Region)
```

# Discussion

Jessica

\newpage

# References
