---
title: "final_project"
author: "Dodjivi Amekoudji, Emily Lang, Jessica Marshall, Kat Vrotsos"
format: html
editor: visual
---

```{r}
install.packages("here")
install.packages("tidyverse")
library(here)
library(tidyverse)
install.packages("skimr")
library(skimr)
install.packages("dplyr")
install.packages("tidyr")
install.packages("knitr")
library(dplyr)
library(tidyr)
library(knitr)


```

# Load the data

```{r}
bmw_sales<- read_csv(here("data", "bmw_sales_data.csv"))
```

The `echo: false` option disables the printing of code (only output is displayed).

```{r}
bmw_sales_decade <- bmw_sales %>% 
  filter(Year >= 2014)
```

```{r}
# rank BMW models by sales volume
# will use object bmw)decade_top3 for inline text describing top 3
bmw_decade_top3 <- bmw_sales_decade |> 
  group_by(Model) |> 
  summarize(Model_Sales = sum(Sales_Volume)) |> 
  arrange(desc(Model_Sales))
```

```{r}

# rank BMW models by sales volume
# will use object bmw)decade_top3 for inline text describing top 3
bmw_decade_top3 <- bmw_sales_decade |> 
  group_by(Model) |> 
  summarize(Model_Sales = sum(Sales_Volume)) |> 
  arrange(desc(Model_Sales))


```

```{r}

# Summarize numeric columns
bmw_decade_top3 %>%
  summarise(across(where(is.numeric), list(mean = mean, sd = sd, min = min, max = max)))

skim(bmw_decade_top3)
```

Top colors by year

```{r}
salescoloryear<- bmw_sales_decade |> 
  select(Color, Year, Sales_Volume)
avgsales<- salescoloryear |> 
  group_by(Year, Color) |>
  summarize(mean_sales = mean(Sales_Volume))

avgsales |>
ggplot(aes(Color,mean_sales)) +
geom_col(aes(fill = Color))+
  facet_wrap(~Year)+
  coord_flip()+
  scale_fill_manual(values = c("black", "blue", "grey", "red", "yellow", "white"))
```

```{r}

# 1. Average Sales by Year and Color
avgsales <- salescoloryear |> 
  group_by(Year, Color) |>
  summarize(mean_sales = mean(Sales_Volume), .groups = "drop")

# 2. Summary Table (Long)
summary_table <- avgsales |>
  arrange(Year, Color)

summary_table

# 3. Formatted Table
kable(
  summary_table,
  col.names = c("Year", "Color", "Mean Sales Volume"),
  caption = "Average BMW Sales by Color and Year"
)

# 4. Wide Table
summary_wide <- avgsales |>
  pivot_wider(
    names_from = Year,
    values_from = mean_sales
  )
summary_stats <- avgsales |>
  group_by(Color) |>
  summarize(
    avg_sales = mean(mean_sales),
    total_sales = sum(mean_sales),
    .groups = "drop"
  )

summary_stats

```
